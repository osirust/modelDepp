# modelDepp
–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–¥ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ Deepfake Detection (Yandex ML Intensive). –¢–µ–∫—É—â–∏–π –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (Private LB): > 0,9.

##  –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (Inference)

–î–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ—à–µ–Ω–∏—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–∞–º–∏ –º—ã –ø–æ–¥–≥–æ—Ç–æ–≤–∏–ª–∏ –æ–±–ª–µ–≥—á–µ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç `inference.py`.
–í —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º **Native MBConv Architecture** (–Ω–∞—Ç–∏–≤–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —Ç–∏–ø–∞ `timm`), —á—Ç–æ–±—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å 100% –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –Ω–∞ –ª—é–±–æ–π –º–∞—à–∏–Ω–µ.

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä –±–∏–±–ª–∏–æ—Ç–µ–∫ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞:

    ‚Ä¢ pip install torch torchvision pandas numpy pillow opencv-python
    
2. –ó–∞–≥—Ä—É–∑–∫–∞ –≤–µ—Å–æ–≤
–ò–∑-–∑–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π GitHub –Ω–∞ —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–æ–≤, —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ –≤–µ—Å–∞ –º–æ–¥–µ–ª–∏ (submission_weights.pth) –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ –≤–Ω–µ—à–Ω–µ–π —Å—Å—ã–ª–∫–µ.

üëâ [–°–ö–ê–ß–ê–¢–¨ –í–ï–°–ê –ú–û–î–ï–õ–ò] (https://drive.google.com/file/d/1zQM880Su1VA5YLTKM05MAanJv9c0YwUt/view?usp=sharing) 
(Google Drive)
–í–∞–∂–Ω–æ: –°–∫–∞—á–∞–π—Ç–µ —Ñ–∞–π–ª –∏ –ø–æ–º–µ—Å—Ç–∏—Ç–µ –µ–≥–æ –≤ –∫–æ—Ä–µ–Ω—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è —Ä—è–¥–æ–º —Å inference.py.

3. –ó–∞–ø—É—Å–∫

    ‚Ä¢ python inference.py

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–π–¥–µ—Ç –ø–∞–ø–∫—É data/faces_384/test, –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ —Å–æ–∑–¥–∞—Å—Ç —Ñ–∞–π–ª submission.csv.

### 2. –≠—Å—Å–µ: –≠–≤–æ–ª—é—Ü–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ –¥–∏–ø—Ñ–µ–π–∫–æ–≤

–¢–µ–º–∞: –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã—Ö –∏ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä –≤ –∑–∞–¥–∞—á–µ –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–∏–ø—Ñ–µ–π–∫–æ–≤.
–í–≤–µ–¥–µ–Ω–∏–µ
–ó–∞–¥–∞—á–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –¥–∏–ø—Ñ–µ–π–∫–æ–≤ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É–µ—Ç—Å—è –≤—ã—Å–æ–∫–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç—å—é –∏–∑-–∑–∞ —Ç–æ–Ω–∫–∏—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ —á–∞—Å—Ç–æ –Ω–µ–≤–∏–¥–∏–º—ã —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–º—É –≥–ª–∞–∑—É. –í —Ä–∞–º–∫–∞—Ö —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è –±—ã–ª–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –¥–≤—É—Ö –ø–æ–¥—Ö–æ–¥–æ–≤: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ª–µ–≥–∫–æ–≤–µ—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã (MobileNetV2Simple) –∏ —Ç—è–∂–µ–ª–æ–π —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã (EfficientNet+FPN+CBAM), —á—Ç–æ –≤ –∏—Ç–æ–≥–µ –ø—Ä–∏–≤–µ–ª–æ –∫ —Å–æ–∑–¥–∞–Ω–∏—é —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è TitanNet V42.
1. –ë–∞–∑–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å: MobileNetV2Simple
–ù–∞ –Ω–∞—á–∞–ª—å–Ω–æ–º —ç—Ç–∞–ø–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –ø—Ä–æ–≤–æ–¥–∏–ª–∏—Å—å —Å –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–µ–π MobileNetV2. –ì–ª–∞–≤–Ω—ã–º –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ–º —ç—Ç–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ –±—ã–ª–∞ —Å–∫–æ—Ä–æ—Å—Ç—å: –æ–±—É—á–µ–Ω–∏–µ –∑–∞–Ω–∏–º–∞–ª–æ –≤—Å–µ–≥–æ 3.5 –º–∏–Ω—É—Ç—ã –Ω–∞ —ç–ø–æ—Ö—É.
–û–¥–Ω–∞–∫–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–∫–∞–∑–∞–ª–∏—Å—å –Ω–µ—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω—ã–º–∏:
    ‚Ä¢ –ù–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ: –õ—É—á—à–∏–π F1-score —Å–æ—Å—Ç–∞–≤–∏–ª –≤—Å–µ–≥–æ 0.3572.
    ‚Ä¢ –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å: –ù–∞–±–ª—é–¥–∞–ª–∞—Å—å –æ–±—Ä–∞—Ç–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É —Ç–æ—á–Ω–æ—Å—Ç—å—é (Precision) –∏ –ø–æ–ª–Ω–æ—Ç–æ–π (Recall). –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –ø–æ–≤—ã—Å–∏—Ç—å Recall –¥–æ 0.70, Precision –ø–∞–¥–∞–ª –¥–æ 0.18.
    ‚Ä¢ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: –ú–æ–¥–µ–ª—å –ø—Ä–æ–ø—É—Å—Ç–∏–ª–∞ 36.5% —Ñ–µ–π–∫–æ–≤ (465 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ 1275).
–í—ã–≤–æ–¥: –õ–µ–≥–∫–æ–≤–µ—Å–Ω—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –±–µ–∑ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤ –≤–Ω–∏–º–∞–Ω–∏—è –Ω–µ —Å–ø–æ—Å–æ–±–Ω—ã —É–ª–æ–≤–∏—Ç—å –≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –¥–∏–ø—Ñ–µ–π–∫–æ–≤, ¬´—Å–≤–∞–ª–∏–≤–∞—è—Å—å¬ª –≤ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –º–∞–∂–æ—Ä–∏—Ç–∞—Ä–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞ (—Ä–µ–∞–ª—å–Ω—ã—Ö –ª–∏—Ü).
2. –ü—Ä–æ—Ä—ã–≤: EfficientNet + FPN + CBAM
–î–ª—è —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º –±–∞–∑–æ–≤–æ–π –º–æ–¥–µ–ª–∏ –±—ã–ª–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –≤–∫–ª—é—á–∞—é—â–∞—è:
    1. Backbone: EfficientNet-B3.
    2. FPN (Feature Pyramid Network): –î–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –º–∞—Å—à—Ç–∞–±–∞—Ö.
    3. CBAM (Convolutional Block Attention Module): –î–ª—è –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏ –∫–∞–Ω–∞–ª—å–Ω–æ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è –∫ –∞–Ω–æ–º–∞–ª–∏—è–º.
–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∫–∞–∑–∞–ª–∏ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–∫–∞—á–æ–∫:
    ‚Ä¢ F1-score: –í—ã—Ä–æ—Å –¥–æ 0.8921 (—É–ª—É—á—à–µ–Ω–∏–µ –Ω–∞ 149.7%).
    ‚Ä¢ –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö —Ñ–µ–π–∫–æ–≤ —Å–æ–∫—Ä–∞—Ç–∏–ª–æ—Å—å –¥–æ 4.9% (–≤—Å–µ–≥–æ 63 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è).
    ‚Ä¢ –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å: –û–±—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ö–æ–¥–∏–ª–æ –ø–ª–∞–≤–Ω–æ, –±–µ–∑ –∫–æ–ª–ª–∞–ø—Å–æ–≤.
–ü–ª–∞—Ç–æ–π –∑–∞ –∫–∞—á–µ—Å—Ç–≤–æ —Å—Ç–∞–ª–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è: –æ–Ω–æ —É–≤–µ–ª–∏—á–∏–ª–æ—Å—å –¥–æ 37.5 –º–∏–Ω—É—Ç –Ω–∞ —ç–ø–æ—Ö—É (–≤ 10.7 —Ä–∞–∑ –¥–æ–ª—å—à–µ). –û–¥–Ω–∞–∫–æ –¥–ª—è –∑–∞–¥–∞—á –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Ç–∞–∫–∏–µ –∑–∞—Ç—Ä–∞—Ç—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–ø—Ä–∞–≤–¥–∞–Ω—ã.
3. –§–∏–Ω–∞–ª: TitanNet V42 (Diamond)
–û–ø–∏—Ä–∞—è—Å—å –Ω–∞ —É—Å–ø–µ—Ö –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤ –≤–Ω–∏–º–∞–Ω–∏—è, –º—ã –ø–µ—Ä–µ—à–ª–∏ –∫ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ TitanNet (–º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π ConvNeXt V2) —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ–º 384x384. –ö–ª—é—á–µ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:
    ‚Ä¢ SSL Pretraining (SimMIM): –ú–æ–¥–µ–ª—å –æ–±—É—á–∞–ª–∞—Å—å –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å —Å–∫—Ä—ã—Ç—ã–µ —á–∞—Å—Ç–∏ –ª–∏—Ü, –≤—ã—É—á–∏–≤–∞—è –≥–µ–æ–º–µ—Ç—Ä–∏—é –ª–∏—Ü–∞ –±–µ–∑ —É—á–∏—Ç–µ–ª—è.
    ‚Ä¢ Pseudo-Labeling: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ ~8000 "–∞–ª–º–∞–∑–Ω—ã—Ö" –ø—Ä–∏–º–µ—Ä–æ–≤ –∏–∑ —Ç–µ—Å—Ç–∞ —Å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å—é >99.5%.
    ‚Ä¢ –†–µ–∑—É–ª—å—Ç–∞—Ç: –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏–ª–æ –ø—Ä–æ–±–∏—Ç—å –ø–æ—Ç–æ–ª–æ–∫ 0.91-0.93 –∏ –¥–æ—Å—Ç–∏—á—å 0.99 –Ω–∞ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–µ.
–ó–∞–∫–ª—é—á–µ–Ω–∏–µ
–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª–æ, —á—Ç–æ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã (MobileNet) –Ω–µ–ø—Ä–∏–≥–æ–¥–Ω—ã –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ–π –¥–µ—Ç–µ–∫—Ü–∏–∏ –¥–∏–ø—Ñ–µ–π–∫–æ–≤. –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –≤ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã (–ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ EfficientNet/TitanNet, —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–æ 512px) –∏ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã (Attention, SSL) –¥–∞—é—Ç —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç –∫–∞—á–µ—Å—Ç–≤–∞, –ø—Ä–µ–≤—Ä–∞—â–∞—è —Å–∏—Å—Ç–µ–º—É –∏–∑ "–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª" –≤ –Ω–∞–¥–µ–∂–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

### 3. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

    ‚Ä¢ Python: 3.10+
    
    ‚Ä¢ GPU: NVIDIA —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π CUDA (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 12GB+ VRAM, –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ RTX 4090/A100).
    
    ‚Ä¢ –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏:
    
Bash

pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121
pip install kornia facenet-pytorch pandas numpy opencv-python tqdm scikit-learn


–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É (Pipeline)

–í–µ—Å—å –ø—Ä–æ—Ü–µ—Å—Å —Ä–∞–∑–±–∏—Ç –Ω–∞ 3 —ç—Ç–∞–ø–∞ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö -> SSL –ü—Ä–µ—Ç—Ä–µ–π–Ω -> –§–∏–Ω–∞–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ.

–®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö (Face Alignment)

–í—ã—Ä–µ–∑–∞–µ–º –ª–∏—Ü–∞ –∏ –ø—Ä–∏–≤–æ–¥–∏–º –∫ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—é 384x384. –°–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç MTCNN —Å "—É–º–Ω—ã–º –∫—Ä–æ–ø–æ–º" (fallback –Ω–∞ —Ü–µ–Ω—Ç—Ä, –µ—Å–ª–∏ –ª–∏—Ü–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ).

Bash

python align_faces.py

    ‚Ä¢ –í—Ö–æ–¥: data/dataset/train_images, data/dataset/test_images
    
    ‚Ä¢ –í—ã—Ö–æ–¥: data/faces_512/train, data/faces_512/test
    
    ‚Ä¢ –í—Ä–µ–º—è: ~1-2 —á–∞—Å–∞.
    
–®–∞–≥ 2: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Å–µ–≤–¥–æ-–ª–µ–π–±–ª–æ–≤ (Mining Diamonds)

–ò—Å–ø–æ–ª—å–∑—É–µ–º –∞–Ω—Å–∞–º–±–ª—å –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏ (V38) –¥–ª—è —Ä–∞–∑–º–µ—Ç–∫–∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å –≤—ã—Å–æ–∫–æ–π —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å—é (threshold > 0.995).

Bash

python make_diamonds.py

    ‚Ä¢ –í—ã—Ö–æ–¥: train_diamond.csv (—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç, ~58k –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π).
    
    ‚Ä¢ –í—Ä–µ–º—è: ~5 –º–∏–Ω—É—Ç.
    
–®–∞–≥ 3: –û—Å–Ω–æ–≤–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ (The Boss)

–ó–∞–ø—É—Å–∫–∞–µ—Ç Self-Supervised Learning (SimMIM) –Ω–∞ 50 —ç–ø–æ—Ö, –∑–∞—Ç–µ–º —Ñ–∞–π–Ω—Ç—é–Ω–∏–Ω–≥ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ –Ω–∞ 5 —Ñ–æ–ª–¥–æ–≤.

Bash

python train_v42_diamond.py

    ‚Ä¢ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: img_size=512, batch_size=8 (virt=32), ssl_epochs=50.
    
    ‚Ä¢ –í—Ä–µ–º—è: ~12-15 —á–∞—Å–æ–≤ (SSL + 5 Folds).
    
    ‚Ä¢ –†–µ–∑—É–ª—å—Ç–∞—Ç: submission_v42.csv –∏ –≤–µ—Å–∞ –º–æ–¥–µ–ª–µ–π.
    

–°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞
–£–±–µ–¥–∏—Å—å, —á—Ç–æ –≤—Å–µ —ç—Ç–∏ —Ñ–∞–π–ª—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º:
1. –°–∫—Ä–∏–ø—Ç—ã (–ö–æ–¥):
    ‚Ä¢ align_faces.py ‚Äî –°–∫—Ä–∏–ø—Ç –¥–ª—è –Ω–∞—Ä–µ–∑–∫–∏ –ª–∏—Ü (MTCNN).
    ‚Ä¢ make_diamonds.py ‚Äî –°–∫—Ä–∏–ø—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Å–µ–≤–¥–æ-–ª–µ–π–±–ª–æ–≤ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞—Ä—ã–µ –≤–µ—Å–∞).
    ‚Ä¢ train_v42_diamond.py ‚Äî –ì–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –æ–±—É—á–µ–Ω–∏—è (SSL + Classification + Inference).
    ‚Ä¢ plot_training_curves.py ‚Äî (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –î–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –æ–±—É—á–µ–Ω–∏—è.
    ‚Ä¢ safe_inference.py ‚Äî (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ó–∞–ø–∞—Å–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞, –µ—Å–ª–∏ –æ—Å–Ω–æ–≤–Ω–æ–π —É–ø–∞–¥–µ—Ç.
2. –î–∞–Ω–Ω—ã–µ:
    ‚Ä¢ data/dataset/train_images/ ‚Äî –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ —Ñ–æ—Ç–æ (—Ç—Ä–µ–π–Ω).
    ‚Ä¢ data/dataset/test_images/ ‚Äî –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ —Ñ–æ—Ç–æ (—Ç–µ—Å—Ç).
    ‚Ä¢ data/dataset/train_solution.csv ‚Äî –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π CSV —Å –º–µ—Ç–∫–∞–º–∏.
3. –í–µ—Å–∞ (–ù–µ–æ–±—Ö–æ–¥–∏–º—ã –¥–ª—è make_diamonds.py):
    ‚Ä¢ titan_backbone_fold[0-4].pth ‚Äî –í–µ—Å–∞ backbone –æ—Ç V38.
    ‚Ä¢ titan_head_fold[0-4].pth ‚Äî –í–µ—Å–∞ –≥–æ–ª–æ–≤—ã –æ—Ç V38.
4. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã–µ —Ñ–∞–π–ª—ã (–ø–æ—è–≤—è—Ç—Å—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ):
    ‚Ä¢ data/faces_512/ ‚Äî –ü–∞–ø–∫–∞ —Å –Ω–∞—Ä–µ–∑–∞–Ω–Ω—ã–º–∏ –ª–∏—Ü–∞–º–∏.
    ‚Ä¢ train_diamond.csv ‚Äî –ù–æ–≤—ã–π CSV —Å –ø—Å–µ–≤–¥–æ-–ª–µ–π–±–ª–∞–º–∏.
    ‚Ä¢ titan_v42_ssl.pth ‚Äî –í–µ—Å–∞ –ø–æ—Å–ª–µ SSL.
    ‚Ä¢ v42_backbone_foldX.pth ‚Äî –§–∏–Ω–∞–ª—å–Ω—ã–µ –≤–µ—Å–∞.
    ‚Ä¢ submission_v42.csv ‚Äî –§–∞–π–ª –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏.

![5](https://github.com/user-attachments/assets/86b288b0-42f0-4f59-a485-072a04772c6b)
![4](https://github.com/user-attachments/assets/d56207ec-bcbe-4e17-a73e-6b5a192d42b9)
![3](https://github.com/user-attachments/assets/9a1a2397-ef88-454b-bd71-97a417e0cc1c)
![2](https://github.com/user-attachments/assets/8ce3d38c-6d96-4aab-8061-0f5216e9e6f9)
![1](https://github.com/user-attachments/assets/d2877698-33d4-49d0-a3f6-cc79f53a275f)



